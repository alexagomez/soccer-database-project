{% load static %}

<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<!-- <link rel="stylesheet" type="text/css" href="{% static 'css/login.css' %}"> -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>

<!DOCTYPE html>
{% load favorite_players_extras %}
<script>
    function searchRedirect() {
        var columns = ['player_name'];
        var redirectParams = [];
        for (var i = 0; i < columns.length; i++) {
            var searchVal = document.getElementById(columns[i]).value;
            if (searchVal != "") {
                redirectParams.push(columns[i] + "=" + searchVal);
            }
        }
        document.location.search = redirectParams.join("&");
    }
</script>
<html lang="en">
    {% for message in messages %}
    {% if 'success' in message.tags %}

    <div class="alert alert-success">
        <a class="close" href="{% url 'view_favorite_players' %}" data-dismiss="alert">×</a>

            {{ message }}

    </div>
{% endif %}
{% endfor %}

{% for message in messages %}
{% if 'error' in message.tags %}
    <div class="alert alert-warning">
        <a class="close" href="{% url 'view_favorite_players' %}" data-dismiss="alert">×</a>

            {{ message }}

    </div>
{% endif %}
{% endfor %}
{% for message in messages %}
{% if 'info' in message.tags %}
    <div class="alert alert-info">
        <a class="close" href="{% url 'view_favorite_players' %}" data-dismiss="alert">×</a>

            {{ message }}

    </div>
{% endif %}
    {% endfor %}
{% if request.session.user %}
    <h1>hello, {{request.session.user}}</h1>
{% endif %}
<h1>Players</h1>
{% with primary_key='username' %}
{% with table_name='favorite_players' %}
<table class="table">
    <tr>
        {% for column in columns %}
            {% if column != 'username' %}
                <input type="text" id="{{column}}" name="{{column}}" placeholder="{{column}}" size="10" value="{% dict_get params column %}">
            {% endif %}
        {% endfor %}
    </tr>
    <button id="btn-search" onclick="searchRedirect()">Search</button>
    <tr>
        {% for column in columns %}
            <td>{{column}}</td>
        {% endfor %}
    </tr>
    {% for record in records %}
        <tr>
            {% for column in columns %}
                {% if column == 'player_name' %}
                    <td><a href="/players/edit?long_name={% dict_get record column %}">{% dict_get record column %}</a></td>
                {% else %}
                    <td>{% dict_get record column %}</td>
                {% endif %}
            {% endfor %}
            <td><a class="btn btn-info" href="/{{table_name}}/delete/{% dict_get record 'player_name' %}">delete from favorites</a></td>
        </tr>
    {% endfor %}
</table>
{% endwith %}
{% endwith %}
</html>