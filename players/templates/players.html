<!DOCTYPE html>
{% load players_extras %}
<script>
    function searchRedirect() {
        var columns = ['long_name', 'age', 'dob', 'height_cm', 'weight_kg', 'nationality', 'passing', 'defending',
                       'shooting', 'dribbling', 'pace', 'overall', 'team_jersey_number', 'preferred_foot', 'wage_eur'];
        var redirectParams = [];
        for (var i = 0; i < columns.length; i++) {
            var searchVal = document.getElementById(columns[i]).value;
            if (searchVal != "") {
                redirectParams.push(columns[i] + "=" + searchVal);
            }
        }
        document.location.search = redirectParams.join("&");
    }
</script>
<html lang="en">
{% if request.session.user %}
    <h1>hello, {{request.session.user}}</h1>
{% endif %}
<h1>Players</h1>

<table>
    <tr>
        {% for column in columns %}
            <input type="text" id="{{column}}" name="{{column}}" placeholder="{{column}}" size="10" value="{% dict_get params column %}">
        {% endfor %}
    </tr>
    <button id="btn-search" onclick="searchRedirect()">Search</button>
    <tr>
        {% for column in columns %}
            <td>{{column}}</td>
        {% endfor %}
    </tr>
    {% for player in players %}
        <tr>
            {% for column in columns %}
                {% with name='long_name' %}
                    {% if column == name %}
                        <td><a href="/players/edit?long_name={% dict_get player column %}">{% dict_get player column %}</a></td>
                    {% endif %}
                    {% if column != name %}
                        <td>{% dict_get player column %}</td>
                    {% endif %}
                {% endwith %}
            {% endfor %}
        </tr>
    {% endfor %}
</table>
</html>